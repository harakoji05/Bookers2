<div class="container">
  <div class="row">
    <% if @book.errors.any? %>
            <div>
                <h2><%= pluralize(@book.errors.count, "error") %> prohibited this product from being saved:</h2>

                <ul>
                  <% @book.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
            </div>
       <% end %>

    <div class="col-xs-3">
      <%= render 'users/profile', user: current_user %>
      <%= render 'books/new_book', book: @book %>
    </div>

    <div class="col-xs-9">
      <h1>Books</h1>
      <table class="table">
        <thead>
        	<tr>
            <th></th>
        		<th>title</th>
        		<th>opinion</th>
            <th colspon="3"></th>
        	</tr>
        </thead>

        <tbody>
         	<% @books.each do |book| %>
         	<tr>
            <td>
              <%= link_to user_path(book.user_id) do %>
                <%= attachment_image_tag book.user, :profile_image, format:'jpeg' , fallback: "img/no_image.jpg",  size: "40x40"%>
              <% end %>
            </td>
            <td><%= link_to book.title ,book_path(book) %></td>
            <td><%= book.body %></td>
            
            <td>
              <% if book.favorited_by?(current_user) %>
                <%= link_to book_favorites_path(book), method: :delete do %>
                  <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i>
                  <%= book.favorites.count %>
                <% end %>
          
              <% else %>
                <%= link_to book_favorites_path(book), method: :post do %>
                  <i class="fa fa-heart-o" aria-hidden="true"></i>
                  <%= book.favorites.count %>
                <% end %>
        
            <% end %>
          </td>
            
            <td>
              <P>コメント数: <%= book.book_comments.count %></P>
            </td>
          </tr>
         	<% end %>
         </tbody>
      </table>
    </div>
  </div>
</div>